USE MASTER
GO

----CREANDO NUEVA BASE DE DATOS
----COMPUTER_GK_SA
IF DB_ID('COMPUTER_GK_SA')IS NOT NULL
BEGIN
 DROP DATABASE COMPUTER_GK_SA
END
GO

CREATE DATABASE COMPUTER_GK_SA
GO

---BASE ACTIVA COMPUTER_GK_SA
USE COMPUTER_GK_SA
GO

---CREANDO UNA NUEVA TABLA LLAMADA : CATEGORIA_PC
IF OBJECT_ID('CATEGORIA_PC') IS NOT NULL
BEGIN  
  DROP TABLE CATEGORIA_PC
END
GO

CREATE TABLE CATEGORIA_PC
(
COD_CATEGORIA  CHAR(3)   NOT NULL,
NOMBRE     VARCHAR(25) NOT NULL,
PRIMARY KEY (COD_CATEGORIA)
)
GO

----CREANDO UNA NUEVA TABLA PRODUCTO 
IF OBJECT_ID('PRODUCTO_PC') IS NOT NULL
BEGIN  
  DROP TABLE PRODUCTO_PC
END
GO

CREATE TABLE PRODUCTO_PC
(
ID_PRODUCTO  CHAR(6)   NOT NULL,
NO_SERIE    VARCHAR(100) NOT NULL,
NOMBRE_PROD  VARCHAR(45) NOT NULL,
DESCRIPCION  VARCHAR(100) NOT NULL,
PRECIO_VENTA  MONEY    NOT NULL,
PRECIO_COSTO  MONEY    NOT NULL,
STOCK_MINIMO  INT     NULL,
STOCK_MAXIMO  INT     NULL,
STOCK_ACTUAL  INT     NOT NULL,
COD_CATEGORIA CHAR(3)   NOT NULL,
PRIMARY KEY (ID_PRODUCTO),
FOREIGN KEY (COD_CATEGORIA) REFERENCES CATEGORIA_PC
)
GO

---CREANDO UNA NUEVA TABLA LLAMADA : CLIENTE_PC
IF OBJECT_ID('CLIENTE_PC') IS NOT NULL
BEGIN  
  DROP TABLE CLIENTE_PC
END
GO

CREATE TABLE CLIENTE_PC
(
ID_CLIENTE    CHAR(6)     NOT NULL,
DNI_CLIENTE    CHAR(8)     NOT NULL,
NOM_CLIENTE    VARCHAR(100)  NOT NULL,
APE_PAT_CLIENTE  VARCHAR(60)   NOT NULL,
APE_MAT_CLIENTE  VARCHAR(60)   NOT NULL,
DIR_CLIENTE    VARCHAR (100)  NOT NULL,
MOV_CLIENTE    CHAR(15)    NOT NULL,
EMAIL_CLIENTE   VARCHAR(100)  NOT NULL
CONSTRAINT PK_CLIENTE PRIMARY KEY (ID_CLIENTE)
)
GO

---CREANDO UNA NUEVA TABLA LLAMADA : DETALLE_BOLETA
IF OBJECT_ID('DETALLE_BOLETA') IS NOT NULL
BEGIN  
  DROP TABLE DETALLE_BOLETA
END
GO

CREATE TABLE DETALLE_BOLETA
(
NUM_BOLETA   CHAR(8)   NOT NULL,
ID_PRODUCTO   CHAR(6)   NOT NULL,
ID_CLIENTE   CHAR(6)   NOT NULL,
CANTIDAD    INT     NOT NULL,
IMPORTE     MONEY    NOT NULL,
ID_EMPLEADO   CHAR(8)   NOT NULL
CONSTRAINT PK_DBOLETA PRIMARY KEY (NUM_BOLETA,ID_PRODUCTO)
CONSTRAINT FK_DBOLETACLIE FOREIGN KEY(ID_CLIENTE)REFERENCES CLIENTE_PC,
CONSTRAINT FK_DBOLETAPROD FOREIGN KEY(ID_PRODUCTO)REFERENCES PRODUCTO_PC
)
GO

----DML

---LENGUAJE DE MANIPULACION DE DATOS

----INSERT INTO


---INSERTANDO REGISTROS EN LA TABLA CATEGORIA_PC
INSERT INTO CATEGORIA_PC
VALUES
('C01','MAINBOARD'),
('C02','PROCESADORES'),
('C03','FUENTES'),
('C04','CASE'),
('C05','PARLANTES'),
('C06','MONITORES'),
('C07','TECLADOS'),
('C08','T_VIDEO'),
('C09','T_SONIDO'),
('C10','MOUSE'),
('C11','TECLADOS'),
('C12','M_RAM'),
('C13','ESTABILIZADORES'),
('C14','UPS'),
('C15','T_USB'),
('C16','POWERCERT'),
('C17','IMPRESORAS'),
('C18','T_RED'),
('C19','CAMARAS'),
('C20','TV'),
('C21','BLUERAY'),
('C22','GRABADORES'),
('C23','SMARTPHONE'),
('C24','T_HDMI'),
('C25','GAME'),
('C26','DISCO DURO'),
('C27','DISCO SSD'),
('C28','NVRAM M2.0'),
('C29','T_FIBRA_OM4'),
('C30','MICROFONO XK'),
('C31','MICROFONO XP3'),
('C32','PATCH CORD UTP'),
('C33','PATH COR FIBRA'),
('C34','RACK U5'),
('C35','SERVIDORES HP'),
('C36','SERVIDORES IBM'),
('C37','SWITCH CISCO CATALYS'),
('C38','SWITCH PALO ALTO'),
('C39','SERVIDORES CISCO'),
('C40','CABLES DE COBRE')
GO

----INSERTANDO REGISTROS EN TABLA PRODUCTO_PC
INSERT INTO PRODUCTO_PC
VALUES
('P00001','HK8023456','MAINBOARD ASUS B450 PREMIE','TARJETA PRINCIPAL',500.00,400.00,'20','100','50','C01'),
('P00002','FRT657YU84','MAINBOARD GIGABYTE B550 ','TARJETA PRINCIPAL',550.00,450.00,'20','100','30','C01'),
('P00003','QW23E4RTY7','TECLADO GENIUS MODELO 345','TECLADO INALAMBRICO', 30.00, 35.00, '50','200','100', 'C11'),
('P00004','FGRT67YUU89I','PARLANTES MICRONICS RT466','SISTEMA DE PARLANTES', 100.00, 120.00,'10','30','20','C05'),
('P00005','ERTFGTY456TY78','MONITOR LED SAMSUNG 40 PULGADAS','MONITOR LED',250.00,280.00,'30','60','35','C06'),
('P00006','FSE34WQ256Y','MONITOR LED AOC 40 PULGADAS','MONITOR LED',255.00,290.00,'30','60','50','C06'),
('P00007','56TY7801WE4','MONITOR LED LG 40 PULGADAS','MONITOR LED',255.00,290.00,'30','60','50','C06'),
('P00008','3456TEE34YU','DISCO DURO SEGATE 2TB','DISCO DURO MAGNETICO',250.00,300.00,'50','100','70','C26'),
('P00009','T45RTGFD23R5','DISCO DURO TOSHIBA 4TB','DISCO DURO MAGNETICO',260.00,310.00,'55','100','80','C26'),
('P00010','34EQQ2DFU8','DISCO SSD TOSHIBA 4TB','DISCO ESTADO SOLIDO',350.00,400.00,'55','100','60','C27'),
('P00011','345REQ67FJ1','FUENTE PC 80+ CORSAIR 700 W','FUENTE DE ENERGIA CERTIFICADA',250.00,300.00,'40','100','36','C03'),
('P00012','12WQ355RFD','FUENTE PC 85+ DTC 600 W','FUENTE DE ENERGIA CERTIFICADA',240.00,280.00,'30','100','60','C03'),
('P00013','34ER6TY8UGGW3','TECLADO MICROSOFT MODELO 265','TECLADO ERGONO USB', 32.00, 40.00, '56','180','79', 'C07'),
('P00015','2QSADFE4912QS','CASE MICRONICS MODELO MIC4569','CASE PARA GAME', 100.00, 140.00, '40','100','48', 'C04'),
('P00016','MRTF4445RT67','CASE TELMAKET MODELO 23456','CASE PARA GAME', 130.00, 200.00, '40','100','70', 'C04'),
('P00017','Q213WE5R6T7','PROCESADOR INTEL 9800 DE 3.6 GHZ','PROCESADOR DE INTEL 8 NUCLEOS ', 700.00, 900.00, '40','100','70', 'C02'), 
('P00018','34EWR6TG','PROCESADOR AMD RYZEN 7800 DE 3.6 GHZ','PROCESADOR DE AMD 8 NUCLEOS ', 500.00, 580.00, '40','100','60', 'C02'),
('P00019','567YU890Y', 'MEMORIA RAM DDR4 DE KINGSTON 16 GB','MODULO DE MEMORIA DIMM ', 180.00, 250.00, '40','100','50', 'C12'),
('P00020','WWEESD34567Y8','MEMORIA RAM DDR4 DE KINGSTON 8 GB','MODULO DE MEMORIA DIMM ', 150.00, 200.00, '40','100','40', 'C12')
GO

---MOSTRANDO CONSULTA DE CIERTOS CAMPOS CON UN ALIAS
SELECT ID_PRODUCTO AS [CODIGO],
    NOMBRE_PROD AS [NOMBRE DE PRODUCTO],
		PRECIO_VENTA AS [PRECIO VENTA],
		STOCK_ACTUAL AS [CANTIDAD ]
FROM PRODUCTO_PC
GO

----ORDENADO
---USANDO ORDER BY DE FORMA DESCENDENTE
SELECT ID_PRODUCTO AS [CODIGO],
    NOMBRE_PROD AS [NOMBRE DE PRODUCTO],
		PRECIO_VENTA AS [PRECIO VENTA],
		STOCK_ACTUAL AS [CANTIDAD ]
FROM PRODUCTO_PC
ORDER BY NOMBRE_PROD DESC
GO

---CONSULTADO UTILIZANDO OPERADORES LIKE
SELECT ID_PRODUCTO AS [CODIGO],
    NOMBRE_PROD AS [NOMBRE DE PRODUCTO],
		PRECIO_VENTA AS [PRECIO VENTA],
		STOCK_ACTUAL AS [CANTIDAD ]
FROM PRODUCTO_PC
WHERE NOMBRE_PROD LIKE '[M-P]%'
ORDER BY NOMBRE_PROD DESC
GO

---PRESENTANDO CONSULTA DE 2 TABLAS
SELECT *
  FROM PRODUCTO_PC PRO
  INNER JOIN CATEGORIA_PC CAT ON PRO.COD_CATEGORIA=CAT.COD_CATEGORIA
GO

SELECT PROD.ID_PRODUCTO,PROD.NOMBRE_PROD,CAT.COD_CATEGORIA,CAT.NOMBRE
  FROM CATEGORIA_PC CAT
  LEFT JOIN PRODUCTO_PC PROD ON CAT.COD_CATEGORIA=PROD.COD_CATEGORIA
GO

